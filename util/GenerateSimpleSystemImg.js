/*
 * 生成一个hello world 的二进制印象文件
 */

var fs = require('fs');
var hex_array = [];
hex_array = hex_array.concat([
    0xeb, 0x4e, 0x90, 0x48, 0x45, 0x4c, 0x4c, 0x4f,
    0x49, 0x50, 0x4c, 0x00, 0x02, 0x01, 0x01, 0x00,
    0x02, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x12, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x40, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x29, 0xff,
    0xff, 0xff, 0xff, 0x48, 0x45, 0x4c, 0x4c, 0x4f,
    0x2d, 0x4f, 0x53, 0x20, 0x20, 0x20, 0x46, 0x41,
    0x54, 0x31, 0x32, 0x20, 0x20, 0x20, 0x00, 0x00
]);

set0(hex_array, 16);

hex_array = hex_array.concat([
    0xb8, 0x00, 0x00, 0x8e, 0xd0, 0xbc, 0x00, 0x7c,
    0x8e, 0xd8, 0x8e, 0xc0, 0xbe, 0x74, 0x7c, 0x8a,
    0x04, 0x83, 0xc6, 0x01, 0x3c, 0x00, 0x74, 0x09,
    0xb4, 0x0e, 0xbb, 0x0f, 0x00, 0xcd, 0x10, 0xeb,
    0xee, 0xf4, 0xeb, 0xfd, 0x0a, 0x0a, 0x68, 0x65,
    0x6c, 0x6c, 0xef, 0x2c, 0x20, 0x77, 0x6f, 0x72,
    0x6c, 0x64, 0x0a, 0x00, 0x00, 0x00, 0x00, 0x00
]);

set0(hex_array, 368);

hex_array = hex_array.concat([
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x55, 0xaa,
    0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
]);
console.log(hex_array);

set0(hex_array, 4600);

hex_array = hex_array.concat([
    0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
]);

set0(hex_array, 1469432);

var buffer = new Buffer(hex_array);
console.log('buffer:', buffer.toString());
fs.writeFileSync('helloos.img', buffer, {},function(err) {
    if(err){
        console.log('[ERROR]', err.stack);
    } else {
        console.log('img generate successfully!');
    }
});

function set0(array, size){
    for(var i=0; i<size; i++){
        array.push(0x00);
    }         
}
